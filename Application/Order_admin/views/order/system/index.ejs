<%- include('../layouts/head_top'); %>
<%- include('../layouts/head_bottom'); %>
<%- include('../layouts/header'); %>
<%- include('../layouts/nav'); %>


<!-- MAIN PANEL -->
<div id="main" role="main">

    <!-- RIBBON -->
    <div id="ribbon">

        <!-- breadcrumb -->
        <ol class="breadcrumb">
            <li>后台管理</li>
            <li>基础数据设置</li>
             <a class="label label-primary"  href="/api/clearCache" style="color:white!important;">清除缓存</a>
        </ol>
        <!-- end breadcrumb -->


    </div>
    <!-- END RIBBON -->

    <!-- MAIN CONTENT -->
    <div id="content">

        <!--<div class="tab-title">-->
            <!--<a class="tab-title-url active" href="/system">基础数据设置</a>-->
            <!--<a class="tab-title-url " href="/system/timeSet">预警时间设置</a>-->
            <!--<a class="tab-title-url " href="/system/timeSet">预警时间设置</a>-->
        <!--</div>-->
        <!-- well -->
        <div class="well no-border no-box-shadow basicDataSet">
            <!-- row -->
            <div class="row">
                <!-- col -->
                <div class="col-xs-4 table-responsive  level-0">
                    <div data-level="level-1" class="text-align-center basicDataTit01 fixed-header">
                     &nbsp;
                    </div>
                    <div class="basicDataTit text-align-center basicDataTit01 fixed-header">
                        类别
                    </div>
                    <table class="table table-bordered table-linkage basicDataFirst ">
                        <tbody class="scrollTbody">
                        <%
                        if(DWY_Helper.isCanLoop(basicDataList)){
                        basicDataList.forEach(function (element, index) { %>
                        <tr key="<%= element.key%>" class="<%= (element.key == "assistantSpaceProd")?"display-none":'' %>">
                            <td ><%= element.name %></td>
                        </tr>
                        <%  })
                        }else{ %>
                        <tr>
                            <td  align="center">暂无数据</td>
                        </tr>
                        <% } %>

                        </tbody>
                    </table>

                </div>

                <div class="col-xs-8 table-responsive level-1">

                        <div data-level="level-1" class="text-align-center basicDataTit01 fixed-header">
                            <a class="label label-primary create status01">新建</a>
                            <a class="label label-primary modify status01">修改</a>
                            <a class="label label-primary open-this status03">启用</a>
                            <a class="label label-danger delete status01">删除</a>
                            <a class="label label-primary see-all status01">查看所有</a>
                            <a class="label label-primary open-all display-none">启用所有</a>
                            <a class="label label-primary revoke status02">撤销</a>
                            <a class="label label-primary save status02">保存</a>
                            <input type="hidden" name="listNum" value="" class="listNum" />
                            <input type="hidden" name="key" value="" class="key"/>
                        </div>
                        <div class="basicDataTit text-align-center basicDataTit01 fixed-header">
                            类别1
                        </div>
                        <table class="table table-bordered table-linkage ">
                            <tbody class="basicDataSec scrollTbody">
                            <tr>
                                <td>请点击左侧进行查看</td>
                            </tr>
                            </tbody>
                        </table>

                </div>

                <div class="col-xs-4 table-responsive level-2  display-none">
                    <div data-level="level-2" class="text-align-center basicDataTit01 fixed-header addField">
                        <a class="label label-primary create status01">新建</a>
                        <a class="label label-primary modify status01">修改</a>
                        <a class="label label-primary open-this status03">启用</a>
                        <a class="label label-danger delete status01">删除</a>
                        <a class="label label-primary see-all status01">查看所有</a>
                        <a class="label label-primary revoke status02">撤销</a>
                        <a class="label label-primary save status02">保存</a>
                        <input type="hidden" name="listNum" value="" class="listNum"/>
                        <input type="hidden" name="key" value="" class="key"/>
                        <input type="hidden" name="parentId" value="" class="parentId" />
                    </div>
                    <div class="basicDataTit text-align-center basicDataTit01 fixed-header">
                        类别2
                    </div>
                    <table class="table table-bordered table-linkage ">
                        <tbody class="basicDataThree scrollTbody">
                        <tr><td>点击左侧进行数据查看</td></tr>
                        </tbody>
                    </table>

                </div>

                <div class="col-xs-4 table-responsive level-3  display-none">
                    <div data-level="level-3" class="text-align-center basicDataTit01 fixed-header">
                        <a class="label label-primary create status01">新建</a>
                        <a class="label label-primary modify status01">修改</a>
                        <a class="label label-primary open-this status03">启用</a>
                        <a class="label label-danger delete status01">删除</a>
                        <a class="label label-primary see-all status01">查看所有</a>
                        <a class="label label-primary revoke status02">撤销</a>
                        <a class="label label-primary save status02">保存</a>
                        <input type="hidden" name="listNum" value="" class="listNum"/>
                        <input type="hidden" name="key" value="" class="key" />
                        <input type="hidden" name="parentId" value="" class="parentId"  />
                        <input type="hidden" name="spaceId" value="" class="spaceId"  />
                    </div>
                    <div class="basicDataTit text-align-center basicDataTit01 fixed-header">
                        类别3
                    </div>
                    <table class="table table-bordered table-linkage ">
                        <tbody class="basicDataFour scrollTbody">
                        <tr><td>点击左侧进行数据查看</td></tr>
                        </tbody>
                    </table>

                </div>
                <!-- end col -->
                <!--col-->
                <!--end col-->
            </div>
            <!-- end row -->
        </div>
        <!-- end well -->
        <!-- well -->
        <!-- end well -->


    </div>
    <!-- END MAIN CONTENT -->

</div>
<!-- END MAIN PANEL -->
<!--新建分包类型-->
<form class="form-horizontal  layer-template" method="post" id="create-subPackageDao-form">

    <div class="row" style="padding-top: 30px;">

        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label"><span class="requird"></span>分包类型:</label>
                    <div class="col-xs-8">
                        <select class="form-control validate[required]" name="code" id="" >
                            <option value="">- 请选择 -</option>
                            <option value="1003">导轨</option>
                            <option value="1004">趟门</option>
                            <option value="1005">功能部件</option>
                            <option value="1006">背面板件</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label" ><span class="requird"></span> 输入值:</label>
                    <div class="col-xs-8">
                        <input class="form-control validate[required]" value="" name="name" id="">
                    </div>
                </div>
            </div>
        </div>
    </div>
  <input type="hidden" name="key" value="subPackageDao"/>
    <div class="row">
        <div class="col-xs-12">
            <hr class="simple">
            <div class="col-xs-12 text-center">
                <a  class="btn btn-primary  margin-right-5 createBtn">
                    <i class="fa fa-save"></i>
                    提交
                </a>
            </div>
        </div>
    </div>
    <div class="dwy-clear"></div>
</form>
<!--END 新建分包类型-->
<!--修改分包类型-->
<form class="form-horizontal  layer-template" method="post" id="modify-subPackageDao-form" >

    <div class="row" style="padding-top: 30px;">

        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label"><span class="requird"></span>分包类型:</label>
                    <div class="col-xs-8">
                        <select class="form-control validate[required]" name="code" id="subPackageDaoCode" >
                            <option value="">- 请选择 -</option>
                            <option value="1003">导轨</option>
                            <option value="1004">趟门</option>
                            <option value="1005">功能部件</option>
                            <option value="1006">背面板件</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label" ><span class="requird"></span> 输入值:</label>
                    <div class="col-xs-8">
                        <input class="form-control validate[required]" value="" name="name" id="subPackageDaoName">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" name="key" value="subPackageDao"/>
    <input type="hidden" name="id" value="" id="subPackageDaoId"/>
    <div class="row">
        <div class="col-xs-12">
            <hr class="simple">
            <div class="col-xs-12 text-center">
                <a  class="btn btn-primary  margin-right-5 modifyBtn" >
                    <i class="fa fa-save"></i>
                    提交
                </a>
            </div>
        </div>
    </div>
    <div class="dwy-clear"></div>
</form>
<!--END 修改分包类型-->

<!--新建物料包装类型-->
<form class="form-horizontal  layer-template" method="post" id="create-assistantPackageType-form">

    <div class="row" style="padding-top: 30px;">

        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label"><span class="requird"></span>入库分类:</label>
                    <div class="col-xs-8">
                        <select class="form-control validate[required]" name="type" >
                            <option value=""> -请选择- </option>
                            <%if(DWY_Helper.isCanLoop(packageCate)){
                                packageCate.forEach(function(element,index){%>
                                <option value="<%= element.id%>"><%= element.name%></option>
                            <%})
                            }%>
                        </select>
                        <p class="text-danger margin-top-10">备注：入库分类只是跟入库相关</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label" ><span class="requird"></span> 输入值:</label>
                    <div class="col-xs-8">
                        <input class="form-control validate[required]" value="" name="name">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" name="parentId" value="0" id="assistantPackageTypeParent" />
    <input type="hidden" name="key" value="assistantPackageType"/>
    <div class="row">
        <div class="col-xs-12">
            <hr class="simple">
            <div class="col-xs-12 text-center">
                <a  class="btn btn-primary  margin-right-5 createBtn1">
                    <i class="fa fa-save"></i>
                    提交
                </a>
            </div>
        </div>
    </div>
    <div class="dwy-clear"></div>
</form>
<!--END 新建物料包装类型-->
<!--修改物料包装类型-->
<form class="form-horizontal  layer-template" method="post" id="modify-assistantPackageType-form" >

    <div class="row" style="padding-top: 30px;">

        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label"><span class="requird"></span>入库分类:</label>
                    <div class="col-xs-8">
                        <select class="form-control validate[required]" name="type"  id="assistantPackageTypeType">
                            <option value=""> -请选择- </option>
                            <%if(DWY_Helper.isCanLoop(packageCate)){
                            packageCate.forEach(function(element,index){%>
                            <option value="<%= element.id%>"><%= element.name%></option>
                            <%})
                            }%>
                        </select>
                        <p class="text-danger margin-top-10">备注：入库分类只是跟入库相关</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-xs-12">
            <div class="col-xs-8">
                <div class="form-group">
                    <label class="col-xs-4 control-label" ><span class="requird"></span> 输入值:</label>
                    <div class="col-xs-8">
                        <input class="form-control validate[required]" value="" name="name" id="assistantPackageTypeName">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" name="id" value="0" id="assistantPackageTypeId"/>
    <input type="hidden" name="parentId" value="" id="assistantPackageTypeParent" />
    <input type="hidden" name="key" value="assistantPackageType"/>
    <div class="row">
        <div class="col-xs-12">
            <hr class="simple">
            <div class="col-xs-12 text-center">
                <a  class="btn btn-primary  margin-right-5 modifyBtn1" >
                    <i class="fa fa-save"></i>
                    提交
                </a>
            </div>
        </div>
    </div>
    <div class="dwy-clear"></div>
</form>
<!--END 修改物料包装类型-->
<%- include('../layouts/footer'); %>
<%- include('../layouts/footer_common_script'); %>
<script type="text/javascript">

    $(document).ready(function () {

        //表单初始验证
        $("#create-subPackageDao-form").validationEngine();
        $("#modify-subPackageDao-form").validationEngine();
        $("#create-assistantPackageType-form").validationEngine();
        $("#modify-assistantPackageType-form").validationEngine();


        //点击basicDataFirst--左边第一栏的tr时
        $(".basicDataFirst>tbody>tr").click(function(){
         var key=$(this).attr("key");
             $("input[name=key]").val(key);

             //初始化二三四栏内容
            $(".basicDataSec").html("");
            $(".basicDataThree").html("");
            $(".basicDataFour").html("");

            //展示的样式
          if(key=='assistantResupplyReason'|| key=='assistantOrderSpaceinfo'){
               $(".level-0").removeClass("col-xs-4").addClass("col-xs-3");
               $(".level-1").removeClass("col-xs-8").addClass("col-xs-3");
               $(".level-2").removeClass("display-none").addClass("col-xs-3");
               $(".level-3").removeClass("display-none").addClass("col-xs-3");
           }
            else if(key=='assistantMaterialUnit'||key=='assistantPackageType')
            {
                $(".level-0").removeClass("col-xs-3").addClass("col-xs-4");
                $(".level-1").removeClass("col-xs-8").removeClass("col-xs-3").addClass("col-xs-4");
                $(".level-2").removeClass("display-none").removeClass("col-xs-3").addClass("col-xs-4");
                $(".level-3").addClass("display-none");
            }
            else{
               $(".level-0").removeClass("col-xs-3").addClass("col-xs-4");
               $(".level-1").removeClass("col-xs-3").removeClass("col-xs-4").addClass("col-xs-8");
               $(".level-2").removeClass("col-xs-3").removeClass("col-xs-4").addClass("display-none");
               $(".level-3").addClass("display-none");
            }


            //订单退单原因添加备注
            if(key=="assistantReviewReson"){
                $(".level-1 .basicDataTit" ).html("类别1"+"<p>22:加盟退回原因 21:受理退回原因 60:排料退回原因 50:拆审退回原因 40:拆单退回原因 20:审单退回原因<p>");
            }
            else{
                $(".level-1 .basicDataTit" ).html("类别1");
            }
            //流水空间信息修改类别三
            if(key=='assistantOrderSpaceinfo'){
                $(".level-3 .basicDataTit" ).html('流水空间产品信息');
            }
            else{
                $(".level-3 .basicDataTit" ).html("类别3");
            }

            //重置按钮
           $('.status01').show();
           $('.status02,.status03').hide();

           $(".level-1 input[name=listNum]").val('');


            //系统项隐藏新建和删除
            if(key=="assistantConfig"){
                $(".create ").hide();
                $(".delete").hide();
            }
            else{
                $(".create").show();
                $(".delete").show();
            }

            //ajax功能
            ajaxFuncOne(key);



        });

        //点击左边第二栏
        $(document).on("click",".basicDataSec>tr",function(){
           var key= $(".level-1 input[name=key]").val();

            $(".level-1 input[name=listNum]").val($(this).index());
            $(".level-2 input[name=listNum]").val('');
            $(".level-3 input[name=listNum]").val('');

            //初始化三四栏内容
            $(".basicDataThree").html("");
            $(".basicDataFour").html("");

            if($(this).attr("stcode")==1){
                var parentId=$(this).attr("id");
                // console.log(parentId);

                $(".level-2 input[name=parentId]").val(parentId);

                if(key=="assistantResupplyReason"){
                    ajaxResupplyReason0ne(parentId);
                }
                if(key=="assistantOrderSpaceinfo"){
                    ajaxOrderSpaceinfoOne(parentId);
                }
                if(key=="assistantMaterialUnit"){
                    ajaxAssistantMaterialUnitOne(parentId);
                }
                if(key=='assistantPackageType'){
                    assistantPackageTypeOne(parentId);
                }
            }
            if($(this).attr("stcode")==0){
                $(".basicDataThree").html('请先启用该项');
            }


        });
        //点击左边第三栏
        $(document).on("click",".basicDataThree>tr",function(){
            var key= $(".level-1 input[name=key]").val();

            $(".level-2 input[name=listNum]").val($(this).index());
            $(".level-3 input[name=listNum]").val('');
            //初始化四栏内容
            $(".basicDataFour").html("");

            if($(this).attr("stcode")==1){
                var parentId=$(this).attr("id");
                // console.log(parentId);

                $(".level-3 input[name=parentId]").val(parentId);

                $(".level-3 input[name=spaceId]").val();

                if(key=="assistantResupplyReason"){
                    ajaxResupplyReasonTwo(parentId);
                }
                if(key=="assistantOrderSpaceinfo"){
                    ajaxOrderSpaceinfoTwo(parentId);
                }
            }
            if($(this).attr("stcode")==0){
                $(".basicDataFour").html('请先启用该项');
            }

        });

        //点击左边第四栏
        $(document).on("click",".basicDataFour>tr",function(){
            $(".level-3 input[name=listNum]").val($(this).index());

        });

    })

    //给禁用项目设置样式
     function disableStyleFuc(obj) {
         $(obj).find("tr").each(function(){
             if($(this).attr("stcode")=='0'){
                 $(this).addClass("disable display-none");
             }
         });
     }

    function ajaxFuncOne(key){
        $.ajax({
            url: '/system/'+key,
            method: 'put',
            success: function (data) {
                //console.log('后台返回回来的data',data);
                $(".basicDataSec").html(data);
                //给禁用项目设置样式
                disableStyleFuc(".basicDataSec");
            },
            error: function (response) {
                layer.close(index);
                errorLayout.normal(response);
            }
        });
    }
    function ajaxResupplyReason0ne(parentId) {
        $.ajax({
            url: '/resupplyReason/'+parentId,
            method: 'put',
            success: function (data) {
                //console.log('补单原因类别2',data);
                $(".basicDataThree").html(data);

                //给禁用项目设置样式
               disableStyleFuc(".basicDataThree")

            },
            error: function (response) {
              layer.close(index);
                errorLayout.normal(response);
            }
        });
    }
    function ajaxResupplyReasonTwo(parentId) {
        $.ajax({
            url: '/resupplyReason/'+parentId,
            method: 'put',
            success: function (data) {
               // console.log('补单原因类别3',data);
                $(".basicDataFour").html(data);
                //给禁用项目设置样式
              disableStyleFuc(".basicDataFour");

            },
            error: function (response) {
              layer.close(index);
                errorLayout.normal(response);
            }
        });
    }
    function ajaxOrderSpaceinfoOne(parentId){
        $.ajax({
            url: '/orderSpaceinfo/'+parentId,
            method: 'put',
            success: function (data) {
                //console.log('空间信息类别2',data);
                $(".basicDataThree").html(data);
                //给禁用项目设置样式
                disableStyleFuc(".basicDataThree")

            },
            error: function (response) {
              layer.close(index);
                errorLayout.normal(response);
            }
        });
    }
    function ajaxOrderSpaceinfoTwo(parentId){
        $.ajax({
            url: '/orderSpaceinfoTwo/'+parentId,
            method: 'put',
            success: function (data) {
               // console.log('空间信息类别3',data);
                $(".basicDataFour").html(data);

                //给禁用项目设置样式
                disableStyleFuc(".basicDataFour")

            },
            error: function (response) {
                layer.close(index);
                errorLayout.normal(response);
            }
        });
    }
    function ajaxAssistantMaterialUnitOne(parentId){
        $.ajax({
            url: '/assistantMaterialUnitTwo/'+parentId,
            method: 'put',
            success: function (data) {
                //console.log('物料单位2',data);
                $(".basicDataThree").html(data);

                //给禁用项目设置样式
                disableStyleFuc(".basicDataThree")

            },
            error: function (response) {
                layer.close(index);
                errorLayout.normal(response);
            }
        });
    }
    function assistantPackageTypeOne(parentId){
        $.ajax({
            url: '/assistantPackageTypeTwo/'+parentId,
            method: 'put',
            success: function (data) {
                //console.log('包装类型2',data);
                $(".basicDataThree").html(data);

                //给禁用项目设置样式
                disableStyleFuc(".basicDataThree")

            },
            error: function (response) {
                layer.close(index);
                errorLayout.normal(response);
            }
        });
    }

</script>

<%- include('./index-model'); %>
<%- include('../layouts/foot'); %>